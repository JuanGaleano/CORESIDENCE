---
title: "TEST: IPUMS_ARG_1970"
author: "CORESIDENCE PROJECT"
abstract: "**Abstract: **This document provides a summary description of variables included in the samples downloaded from IPUMS to build the CORESIDENCE database. If you need to report any mistake, please contact jgaleano@ced.uab.es. You can access the source r-code to render this document at: [GitHub CORESIDENCE](https://github.com/JuanGaleano/CORESIDENCE/blob/main/TEST_IMPUMS.qmd)"
mainfont: Arial
monofont: Arial
format: pdf
editor: visual
---

```{r}
#| echo: false
#| warning: false
library(purrr)
library(knitr)
library(kableExtra)
library(tidyverse)
library(visdat)
library(crosstable)

load("G:\\Shared drives\\CORESIDENCE\\WP2_DATA\\2_1_Input Data\\CENSUS_IPUMS\\IPUMS_ARG_1970.Rdata")
```

## COUNTRY: ARGENTINA \| YEAR: 1970 \| SAMPLE SIZE: `r nrow(df)` CASES

### 1. VARIABLES WITH ALL NAs

```{r fig.width=12, fig.height=8}
#| echo: false
#| warning: FALSE
allNas<- data.frame(Variables=df %>% keep(~all(is.na(.x))) %>% names, 
                    Description=c(attributes(df$FORMTYPE)$var_desc,
                                  attributes(df$URBAN)$var_desc,
                                  attributes(df$RESIDENT)$var_desc,
                                  attributes(df$BIRTHYR)$var_desc,
                                  attributes(df$CITIZEN)$var_desc)); kbl(allNas,booktabs = T)%>%kable_styling(full_width = T,position = "center") %>%
column_spec(2, width = "30em")

```

### 2. POPULATION PYRAMID (AGE x SEX)

```{r fig.width=12, fig.height=8}
#| echo: false
#| warning: FALSE
SEX_AGE<-df%>%
  select(SEX,AGE)%>%
  filter(SEX!=9)

SEX_AGE$id<-paste(SEX_AGE$AGE,SEX_AGE$SEX, sep="-")
SEX_AGE <- SEX_AGE %>% group_by(id,SEX,AGE) %>%
  summarise(pop = n())


dfedades<-data.frame(AGE=rep(c(0:110),2),
                     SEX=rep(c(1,2),each=111))

dfedades$id<-paste(dfedades$AGE,dfedades$SEX, sep="-")

SEX_AGE<-as.data.frame(SEX_AGE)
dfedades<-as.data.frame(dfedades)
df_PIR <- data.frame(dfedades,
                     SEX_AGE[match(dfedades[,"id"],
                                   SEX_AGE[,"id"]),])

df_PIR<-df_PIR %>%
        select(AGE,SEX,id,pop)%>%
        mutate(pop2=ifelse(SEX==1, pop*-1, pop))

df_PIR$pop2[is.na(df_PIR$pop2)] <- 0

gg_color_hue <- function(n) {
  hues = seq(15, 375, length=n+1)
  hcl(h=hues, l=65, c=100)[1:n]
}
cols = gg_color_hue(2)
df_PIR$SEX<-as.factor(df_PIR$SEX)
levels(df_PIR$SEX)<-c("Male", "Female")

ggplot(df_PIR, aes(x=AGE, y=pop2, fill=factor(SEX)))+
  geom_bar(colour = I("Black"),
           stat="identity", 
           position="identity", 
           size=.1, alpha =1)+
  coord_flip()+
  labs(#title=unique(df$ndis),
       x="Age",
       y="")+
  scale_fill_manual(values = rev(c(cols)),
                    guide = guide_legend(direction = "horizontal",
                                         nrow = 1,
                                         keywidth=5,
                                         keyheight=1,
                                         label.position = "bottom"))+
  scale_x_continuous(breaks=seq(0,110,5))+
  theme(plot.title = element_text(lineheight=5.6, vjust=1.5,size=12, face="bold"),
        legend.title = element_blank(),
        legend.text = element_text(colour="black",face="bold", size = 15),
        legend.position=c(.5075,.95),
        axis.text.x = element_blank(),
        axis.ticks.x = element_blank(),
        axis.text  = element_text(angle = 0,vjust=0.5, size=15,colour="black"),
        axis.title  = element_text(angle = 0,vjust=0.5, size=15,colour="black"),
        legend.background = element_rect(fill = NA),
        panel.background = element_rect(fill = "#ffffff"),
        plot.background = element_rect(fill = "#ffffff"),
        panel.grid.major=element_line(colour="#f2f2f2",size = .2), 
        panel.grid.minor=element_line(colour="#f2f2f2")) 

```

### 2.1 Frequencies SEX

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
SEX<- df%>% 
  select(SEX)%>%
  group_by(as_factor(SEX)) %>% 
  summarise(n=n())%>% 
  mutate(n_rel = round(n / sum(n)*100,2))

kbl(SEX,booktabs = T)%>%kable_styling(full_width = T,position = "center") %>%
column_spec(1, width = "30em")

```

### 2.2 Frequencies AGE2

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
AGE2<- df%>% 
  select(AGE2)%>%
  group_by(as_factor(AGE2)) %>% 
  summarise(n=n())%>% 
  mutate(n_rel = round(n / sum(n)*100,2))

kbl(AGE2,booktabs = T)%>%kable_styling(full_width = T,position = "center") %>%
column_spec(1, width = "30em")

```

### 3. RELATION OF INDIVIDUAL TO THE HEAD OF THE HOUSEHOLD: RELATE

`r attributes(df$RELATE)$var_desc`

### 3.1 NAs in RELATE, RELATED

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
REL<-df%>%
  select(RELATE, RELATED)
vis_miss(REL,warn_large_data=FALSE)+
  theme(legend.title = element_blank(),
        legend.text = element_text(colour="black",face="bold", size = 15),
        axis.text  = element_text(angle = 0,vjust=0.5, size=15,colour="black"),
        axis.text.x  = element_text(angle = 0,vjust=0.5, size=15,colour="black",hjust=.5),
        axis.title  = element_text(angle = 0,vjust=0.5, size=15,colour="black")) 
```

### 3.2 Frequencies RELATE

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
RELATE<- REL%>% 
  group_by(as_factor(RELATE)) %>% 
  summarise(n=n())%>% 
  mutate(n_rel = round(n / sum(n)*100,2))

kbl(RELATE,booktabs = T)%>%kable_styling(full_width = T,position = "center") %>%
column_spec(1, width = "30em")

```

### 3.3 Frequencies RELATED

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
RELATED<- REL%>% 
  group_by(as_factor(RELATED)) %>% 
  summarise(n=n())%>% 
  mutate(n_rel = round(n / sum(n)*100,2))

kbl(RELATED,booktabs = T)%>%kable_styling(full_width = T,position = "center") %>%
column_spec(1, width = "30em")

```

### 3.4 Population pyramid (AGE x SEX x RELATE)

```{r fig.width=12, fig.height=8.5}
#| echo: false
#| warning: FALSE

SEX_AGE_RELATE<-df%>%
  select(SEX,AGE,RELATE)%>%
  filter(SEX!=9)

SEX_AGE_RELATE$id<-paste(SEX_AGE_RELATE$AGE,SEX_AGE_RELATE$SEX,SEX_AGE_RELATE$RELATE, sep="-")

SEX_AGE_RELATE <- SEX_AGE_RELATE %>% group_by(id,SEX,AGE,RELATE) %>%
  summarise(pop = n())

dfedades_relate<-data.frame(AGE=rep(c(0:110),14),
                     SEX=rep(rep(c(1,2),each=111),7),
                     RELATE=rep(rep(c(1:7), each=111),2))

dfedades_relate$id<-paste(dfedades_relate$AGE,dfedades_relate$SEX,dfedades_relate$RELATE, sep="-")

SEX_AGE_RELATE<-as.data.frame(SEX_AGE_RELATE)
dfedades_relate<-as.data.frame(dfedades_relate)
df_PIR_RELATE <- data.frame(dfedades_relate,
               SEX_AGE_RELATE[match(dfedades_relate[,"id"],
                                          SEX_AGE_RELATE[,"id"]),])

df_PIR_RELATE<-df_PIR_RELATE %>%
  select(AGE,SEX,RELATE,id,pop)%>%
  mutate(pop2=ifelse(SEX==1, pop*-1, pop))

df_PIR_RELATE$pop2[is.na(df_PIR_RELATE$pop2)] <- 0

cols_relate = gg_color_hue(7)

df_PIR_RELATE$SEX<-as.factor(df_PIR_RELATE$SEX)
levels(df_PIR_RELATE$SEX)<-c("Male", "Female")

df_PIR_RELATE$RELATE<-as.factor(df_PIR_RELATE$RELATE)
levels(df_PIR_RELATE$RELATE)<-c("Head","Spouse/partner","Child","Other relative","Non-relative","Other relative or\nnon-relative","Unknown")

ggplot(df_PIR_RELATE, aes(x=AGE, y=pop2, fill=factor(RELATE)))+
  geom_bar(colour = I("Black"),
           stat="identity", 
           position="stack", 
           size=.3, alpha =1)+
  coord_flip()+
  labs(#title=unique(df$ndis),
    x="Age",
    y="")+
  scale_fill_manual(values = c(cols_relate),
                    guide = guide_legend(direction = "horizontal",
                                         nrow = 1,
                                         keywidth=7,
                                         keyheight=1.25,
                                         label.position = "bottom"))+
  scale_x_continuous(breaks=seq(0,110,5))+
  theme(plot.title = element_text(lineheight=5.6, vjust=1.5,size=12, face="bold"),
        legend.title = element_blank(),
        legend.text = element_text(colour="black", size = 12),
        legend.position="bottom",
        axis.text.x = element_blank(),
        axis.text.y = element_text(colour="black", size = 12),
        axis.title.y = element_text(colour="black", size = 12),
        axis.ticks.x = element_blank(),
        legend.background = element_rect(fill = NA),
        panel.background = element_rect(fill = "#ffffff"),
        plot.background = element_rect(fill = "#ffffff"),
        panel.grid.major=element_line(colour="#f2f2f2",size = .2), 
        panel.grid.minor=element_line(colour="#f2f2f2")) 
```

### 4. NATIVITY and COUNTRY OF BIRTH: NATIVITY, BPLCOUNTRY

### 4.1 NAs in NATIVITY, BPLCOUNTRY

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
NATIVITY_BPLCOUNTRY<-df%>%
  select(NATIVITY,BPLCOUNTRY)
vis_miss(NATIVITY_BPLCOUNTRY,warn_large_data=FALSE)+
  theme(legend.title = element_blank(),
        legend.text = element_text(colour="black",face="bold", size = 15),
        axis.text  = element_text(angle = 0,vjust=0.5, size=15,colour="black"),
        axis.text.x  = element_text(angle = 0,vjust=0.5, size=15,colour="black",hjust=.5),
        axis.title  = element_text(angle = 0,vjust=0.5, size=15,colour="black")) 
```

### 4.2 Frequencies NATIVITY

`r attributes(df$NATIVITY)$var_desc`

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
NATIVITY<- NATIVITY_BPLCOUNTRY%>% 
  group_by(as_factor(NATIVITY)) %>% 
  summarise(n=n())%>% 
  mutate(n_rel = round(n / sum(n)*100,2))

kbl(NATIVITY, booktabs = T)%>%kable_styling(full_width = T,position = "center") %>%
column_spec(1, width = "30em")
```

### 4.3 Frequencies BPLCOUNTRY

`r attributes(df$BPLCOUNTRY)$var_desc`

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
BPLCOUNTRY<- NATIVITY_BPLCOUNTRY%>% 
  group_by(as_factor(BPLCOUNTRY)) %>% 
  summarise(n=n())%>% 
  mutate(n_rel = round(n / sum(n)*100,2))

kbl(BPLCOUNTRY, booktabs = T)%>%kable_styling(full_width = T,position = "center") %>%
column_spec(1, width = "30em")
```

### 5. NAs in HEADLOC, MOMLOC, POPLOC, SPLOC

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
LOC<-df%>%
  select(HEADLOC,MOMLOC,POPLOC,SPLOC)
vis_miss(LOC,warn_large_data=FALSE)+
  theme(legend.title = element_blank(),
        legend.text = element_text(colour="black",face="bold", size = 15),
        axis.text  = element_text(angle = 0,vjust=0.5, size=15,colour="black"),
        axis.text.x  = element_text(angle = 0,vjust=0.5, size=15,colour="black",hjust=.5),
        axis.title  = element_text(angle = 0,vjust=0.5, size=15,colour="black")) 
```

### 5.1 Frequencies HEADLOC

`r attributes(df$HEADLOC)$var_desc`

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
HEADLOC<- LOC%>% #nota: tambien hay informacion sobre la cantidad de habitaciones lo que puede dar una idea del tamaÃ±o de la casa
  mutate(fct_explicit_na(as_factor(HEADLOC), na_level = "(Missing)"))%>%
  group_by(as_factor(HEADLOC)) %>% 
  summarise(n=n())%>% 
  mutate(n_rel = round(n / sum(n)*100,2))

kbl(HEADLOC,booktabs = T)%>%kable_styling(full_width = T,position = "center") %>%
column_spec(1, width = "30em")

```

### 5.2 Frequencies MOMLOC

`r attributes(df$MOMLOC)$var_desc`

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
MOMLOC<- LOC%>% #nota: tambien hay informacion sobre la cantidad de habitaciones lo que puede dar una idea del tamaÃ±o de la casa
  mutate(fct_explicit_na(as_factor(MOMLOC), na_level = "(Missing)"))%>%
  group_by(as_factor(MOMLOC)) %>% 
  summarise(n=n())%>% 
  mutate(n_rel = round(n / sum(n)*100,2))

kbl(MOMLOC,booktabs = T)%>%kable_styling(full_width = T,position = "center") %>%
column_spec(1, width = "30em")

```

### 5.3 Frequencies POPLOC

`r attributes(df$POPLOC)$var_desc`

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
POPLOC<- LOC%>% #nota: tambien hay informacion sobre la cantidad de habitaciones lo que puede dar una idea del tamaÃ±o de la casa
  mutate(fct_explicit_na(as_factor(POPLOC), na_level = "(Missing)"))%>%
  group_by(as_factor(POPLOC)) %>% 
  summarise(n=n())%>% 
  mutate(n_rel = round(n / sum(n)*100,2))

kbl(POPLOC,booktabs = T)%>%kable_styling(full_width = T,position = "center") %>%
column_spec(1, width = "30em")

```

### 5.4 Frequencies SPLOC

`r attributes(df$SPLOC)$var_desc`

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
SPLOC<- LOC%>% #nota: tambien hay informacion sobre la cantidad de habitaciones lo que puede dar una idea del tamaÃ±o de la casa
  mutate(fct_explicit_na(as_factor(SPLOC), na_level = "(Missing)"))%>%
  group_by(as_factor(SPLOC)) %>% 
  summarise(n=n())%>% 
  mutate(n_rel = round(n / sum(n)*100,2))

kbl(SPLOC,booktabs = T)%>%kable_styling(full_width = T,position = "center") %>%
column_spec(1, width = "30em")

```

### 6. NAs in NFAMS, NCOUPLES, NMOTHERS, NFATHERS, NCHILD, NCHLT5

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
N_FAM<-df%>%
  select(NFAMS, NCOUPLES, NMOTHERS, NFATHERS,NCHILD,NCHLT5)
vis_miss(N_FAM,warn_large_data=FALSE)+
  theme(legend.title = element_blank(),
        legend.text = element_text(colour="black",face="bold", size = 15),
        axis.text  = element_text(angle = 0,vjust=0.5, size=15,colour="black"),
        axis.text.x  = element_text(angle = 0,vjust=0.5, size=15,colour="black",hjust=.5),
        axis.title  = element_text(angle = 0,vjust=0.5, size=15,colour="black")) 
```

### 6.1 Frequencies NFAMS

`r attributes(df$NFAMS)$var_desc`

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
NFAMS<- N_FAM%>% 
  group_by(as_factor(NFAMS)) %>% 
  summarise(n=n())%>% 
  mutate(n_rel = round(n / sum(n)*100,2))

kbl(NFAMS, booktabs = T)%>%kable_styling(full_width = T,position = "center") %>%
column_spec(1, width = "30em")

```

### 6.2 Frequencies NCOUPLES

`r attributes(df$NCOUPLES)$var_desc`

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
NCOUPLES<- N_FAM%>% 
  group_by(as_factor(NCOUPLES)) %>% 
  summarise(n=n())%>% 
  mutate(n_rel = round(n / sum(n)*100,2))

kbl(NCOUPLES, booktabs = T)%>%kable_styling(full_width = T,position = "center") %>%
column_spec(1, width = "30em")

```

### 6.3 Frequencies NMOTHERS

`r attributes(df$NMOTHERS)$var_desc`

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
NMOTHERS<- N_FAM%>% 
  group_by(as_factor(NMOTHERS)) %>% 
  summarise(n=n())%>% 
  mutate(n_rel = round(n / sum(n)*100,2))

kbl(NMOTHERS, booktabs = T)%>%kable_styling(full_width = T,position = "center") %>%
column_spec(1, width = "30em")

```

### 6.4 Frequencies NFATHERS

`r attributes(df$NFATHERS)$var_desc`

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
NFATHERS<- N_FAM%>% 
  group_by(as_factor(NFATHERS)) %>% 
  summarise(n=n())%>% 
  mutate(n_rel = round(n / sum(n)*100,2))

kbl(NFATHERS, booktabs = T)%>%kable_styling(full_width = T,position = "center") %>%
column_spec(1, width = "30em")

```

### 6.5 Frequencies NCHILD

`r attributes(df$NCHILD)$var_desc`

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
NCHILD<- N_FAM%>% 
  group_by(as_factor(NCHILD)) %>% 
  summarise(n=n())%>% 
  mutate(n_rel = round(n / sum(n)*100,2))

kbl(NCHILD, booktabs = T)%>%kable_styling(full_width = T,position = "center") %>%
column_spec(1, width = "30em")

```

### 6.5 Frequencies NCHLT5

`r attributes(df$NCHLT5)$var_desc`

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
NCHLT5<- N_FAM%>% 
  group_by(as_factor(NCHLT5)) %>% 
  summarise(n=n())%>% 
  mutate(n_rel = round(n / sum(n)*100,2))

kbl(NCHLT5, booktabs = T)%>%kable_styling(full_width = T,position = "center") %>%
column_spec(1, width = "30em")

```

### 7. NAs in AGE_HEAD, AGE_MOM, AGE_POP, AGE_SP

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
AGE<-df%>%
  select(AGE_HEAD, AGE_MOM, AGE_POP, AGE_SP)
vis_miss(AGE,warn_large_data=FALSE)+
  theme(legend.title = element_blank(),
        legend.text = element_text(colour="black",face="bold", size = 15),
        axis.text  = element_text(angle = 0,vjust=0.5, size=15,colour="black"),
        axis.text.x  = element_text(angle = 0,vjust=0.5, size=15,colour="black",hjust=.5),
        axis.title  = element_text(angle = 0,vjust=0.5, size=15,colour="black")) 
```

### 8. NAs in ELDCH and YNGCH

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
ELDCH0<-df%>%
  select(ELDCH, YNGCH)
vis_miss(ELDCH0,warn_large_data=FALSE)+
  theme(legend.title = element_blank(),
        legend.text = element_text(colour="black",face="bold", size = 15),
        axis.text  = element_text(angle = 0,vjust=0.5, size=15,colour="black"),
        axis.text.x  = element_text(angle = 0,vjust=0.5, size=15,colour="black",hjust=.5),
        axis.title  = element_text(angle = 0,vjust=0.5, size=15,colour="black")) 
```

### 8.1 Frequencies in ELDCH

`r attributes(df$ELDCH)$var_desc`

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
ELDCH<- ELDCH0%>% 
  group_by(as_factor(ELDCH)) %>% 
  summarise(n=n())%>% 
  mutate(n_rel = round(n / sum(n)*100,2))

#kbl(ELDCH, booktabs = T)%>%kable_styling(full_width = T,position = "center") %>%column_spec(1, width = "30em")
```

### 8.2 Frequencies in YNGCH

`r attributes(df$YNGCH)$var_desc`

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
YNGCH<- ELDCH0%>% 
  group_by(as_factor(YNGCH)) %>% 
  summarise(n=n())%>% 
  mutate(n_rel = round(n / sum(n)*100,2))

#kbl(YNGCH, booktabs = T)%>%kable_styling(full_width = T,position = "center") %>% column_spec(1, width = "30em")
```

### 9. NUMBER OF CHILDREN BORN: CHBORN, CHSURV

### 9.1 NAs in CHBORN, CHSURV

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
CHBORN_SURV<-df%>%
  select(CHBORN,CHSURV)
vis_miss(CHBORN_SURV,warn_large_data=FALSE)+
  theme(legend.title = element_blank(),
        legend.text = element_text(colour="black",face="bold", size = 15),
        axis.text  = element_text(angle = 0,vjust=0.5, size=15,colour="black"),
        axis.text.x  = element_text(angle = 0,vjust=0.5, size=15,colour="black",hjust=.5),
        axis.title  = element_text(angle = 0,vjust=0.5, size=15,colour="black")) 
```

### 9.2 Frequencies CHBORN

`r attributes(df$CHBORN)$var_desc`

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
CHBORN<- CHBORN_SURV%>% 
  group_by(as_factor(CHBORN)) %>% 
  summarise(n=n())%>% 
  mutate(n_rel = round(n / sum(n)*100,2))

kbl(CHBORN, booktabs = T)%>%kable_styling(full_width = T,position = "center") %>%
column_spec(1, width = "30em")
```

### 9.3 Frequencies CHSURV

`r attributes(df$CHSURV)$var_desc`

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
CHSURV<- CHBORN_SURV%>% 
  group_by(as_factor(CHSURV)) %>% 
  summarise(n=n())%>% 
  mutate(n_rel = round(n / sum(n)*100,2))

kbl(CHSURV, booktabs = T)%>%kable_styling(full_width = T,position = "center") %>%
column_spec(1, width = "30em")
```

### 10. NAs in FAMSIZE

`r attributes(df$FAMSIZE)$var_desc`

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
FAMSIZE0<-df%>%
  select(FAMSIZE)
vis_miss(FAMSIZE0,warn_large_data=FALSE)+
  theme(legend.title = element_blank(),
        legend.text = element_text(colour="black",face="bold", size = 15),
        axis.text  = element_text(angle = 0,vjust=0.5, size=15,colour="black"),
        axis.text.x  = element_text(angle = 0,vjust=0.5, size=15,colour="black",hjust=.5),
        axis.title  = element_text(angle = 0,vjust=0.5, size=15,colour="black")) 
```

### 10.1 Frequencies in FAMSIZE

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
FAMSIZE<- FAMSIZE0%>% 
  group_by(as_factor(FAMSIZE)) %>% 
  summarise(n=n())%>% 
  mutate(n_rel = round(n / sum(n)*100,2))

kbl(FAMSIZE, booktabs = T)%>%kable_styling(full_width = T,position = "center") %>%
column_spec(1, width = "30em")
```

### 11. EDUCATION: EDATTAIN

`r attributes(df$EDATTAIN_HEAD)$var_desc`

### 11.1 NAs in EDATTAIN, EDATTAIND

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
EDATTAIN<-df%>%
  select(EDATTAIN,EDATTAIND)
vis_miss(EDATTAIN,warn_large_data=FALSE)+
  theme(legend.title = element_blank(),
        legend.text = element_text(colour="black",face="bold", size = 15),
        axis.text  = element_text(angle = 0,vjust=0.5, size=15,colour="black"),
        axis.text.x  = element_text(angle = 0,vjust=0.5, size=15,colour="black",hjust=.5),
        axis.title  = element_text(angle = 0,vjust=0.5, size=15,colour="black")) 
```

### 11.2 Frequencies EDATTAIN

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
EDATTAIN0<- EDATTAIN%>% 
  group_by(as_factor(EDATTAIN)) %>% 
  summarise(n=n())%>% 
  mutate(n_rel = round(n / sum(n)*100,2))

kbl(EDATTAIN0, booktabs = T)%>%kable_styling(full_width = T,position = "center") %>%
column_spec(1, width = "30em")
```

### 11.3 Frequencies EDATTAIND

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
EDATTAIND<- EDATTAIN%>% 
  group_by(as_factor(EDATTAIND)) %>% 
  summarise(n=n())%>% 
  mutate(n_rel = round(n / sum(n)*100,2))

kbl(EDATTAIND, booktabs = T)%>%kable_styling(full_width = T,position = "center") %>%
column_spec(1, width = "30em")
```

### 11.4 NAs in EDATTAIN_HEAD, EDATTAIN_MOM, EDATTAIN_POP, EDATTAIN_SP

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
EDATTAIN1<-df%>%
  select(EDATTAIN_HEAD, EDATTAIN_MOM, EDATTAIN_POP, EDATTAIN_SP)
vis_miss(EDATTAIN1,warn_large_data=FALSE)+
  theme(legend.title = element_blank(),
        legend.text = element_text(colour="black",face="bold", size = 15),
        axis.text  = element_text(angle = 0,vjust=0.5, size=15,colour="black"),
        axis.text.x  = element_text(angle = 0,vjust=0.5, size=15,colour="black",hjust=.5),
        axis.title  = element_text(angle = 0,vjust=0.5, size=15,colour="black")) 
```

### 11.5 Frequencies EDATTAIN_HEAD

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
EDATTAIN_HEAD<- EDATTAIN1%>% 
  group_by(as_factor(EDATTAIN_HEAD)) %>% 
  summarise(n=n())%>% 
  mutate(n_rel = round(n / sum(n)*100,2))

kbl(EDATTAIN_HEAD, booktabs = T)%>%kable_styling(full_width = T,position = "center") %>%
column_spec(1, width = "30em")
```

### 11.6 Frequencies EDATTAIN_MOM

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
EDATTAIN_MOM<- EDATTAIN1%>% 
  group_by(as_factor(EDATTAIN_MOM)) %>% 
  summarise(n=n())%>% 
  mutate(n_rel = round(n / sum(n)*100,2))

kbl(EDATTAIN_MOM, booktabs = T)%>%kable_styling(full_width = T,position = "center") %>%
column_spec(1, width = "30em")

```

### 11.7 Frequencies EDATTAIN_POP

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
EDATTAIN_POP<- EDATTAIN1%>% 
  group_by(as_factor(EDATTAIN_POP)) %>% 
  summarise(n=n())%>% 
  mutate(n_rel = round(n / sum(n)*100,2))

kbl(EDATTAIN_POP, booktabs = T)%>%kable_styling(full_width = T,position = "center") %>%
column_spec(1, width = "30em")

```

### 11.8 Frequencies EDATTAIN_SP

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
EDATTAIN_SP<- EDATTAIN1%>% 
  group_by(as_factor(EDATTAIN_SP)) %>% 
  summarise(n=n())%>% 
  mutate(n_rel = round(n / sum(n)*100,2))

kbl(EDATTAIN_SP, booktabs = T)%>%kable_styling(full_width = T,position = "center") %>%
column_spec(1, width = "30em")
```

### 11.9 NAs in SCHOOL

`r attributes(df$SCHOOL)$var_desc`

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
SCHOOL0<-df%>%
  select(SCHOOL)
vis_miss(SCHOOL0,warn_large_data=FALSE)+
  theme(legend.title = element_blank(),
        legend.text = element_text(colour="black",face="bold", size = 15),
        axis.text  = element_text(angle = 0,vjust=0.5, size=15,colour="black"),
        axis.text.x  = element_text(angle = 0,vjust=0.5, size=15,colour="black",hjust=.5),
        axis.title  = element_text(angle = 0,vjust=0.5, size=15,colour="black")) 
```

### 11.10 Frequencies in SCHOOL

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
SCHOOL<- SCHOOL0%>% 
  group_by(as_factor(SCHOOL)) %>% 
  summarise(n=n())%>% 
  mutate(n_rel = round(n / sum(n)*100,2))

kbl(SCHOOL, booktabs = T)%>%kable_styling(full_width = T,position = "center") %>%
column_spec(1, width = "30em")
```

### 11.11 NAs in LIT

`r attributes(df$LIT)$var_desc`

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
LIT0<-df%>%
  select(LIT)

vis_miss(LIT0,warn_large_data=FALSE)+
  theme(legend.title = element_blank(),
        legend.text = element_text(colour="black",face="bold", size = 15),
        axis.text  = element_text(angle = 0,vjust=0.5, size=15,colour="black"),
        axis.text.x  = element_text(angle = 0,vjust=0.5, size=15,colour="black",hjust=.5),
        axis.title  = element_text(angle = 0,vjust=0.5, size=15,colour="black")) 
```

### 11.12 Frequencies in LIT

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
LIT<- LIT0%>% 
  group_by(as_factor(LIT)) %>% 
  summarise(n=n())%>% 
  mutate(n_rel = round(n / sum(n)*100,2))

kbl(LIT, booktabs = T)%>%kable_styling(full_width = T,position = "center") %>%
column_spec(1, width = "30em")
```

### 12. LABOUR FORCE: EMPSTAT

`r attributes(df$EMPSTAT)$var_desc`

### 12.1 NAs in EMPSTAT, EMPSTATD

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
EMPSTAT<-df%>%
  select(EMPSTAT, EMPSTATD)
vis_miss(EMPSTAT,warn_large_data=FALSE)+
  theme(legend.title = element_blank(),
        legend.text = element_text(colour="black",face="bold", size = 15),
        axis.text  = element_text(angle = 0,vjust=0.5, size=15,colour="black"),
        axis.text.x  = element_text(angle = 0,vjust=0.5, size=15,colour="black",hjust=.5),
        axis.title  = element_text(angle = 0,vjust=0.5, size=15,colour="black")) 
```

### 12.2 Frequencies EMPSTAT

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
EMPSTAT0<- EMPSTAT%>% 
  group_by(as_factor(EMPSTAT)) %>% 
  summarise(n=n())%>% 
  mutate(n_rel = round(n / sum(n)*100,2))

kbl(EMPSTAT0, booktabs = T)%>%kable_styling(full_width = T,position = "center") %>%
column_spec(1, width = "30em")

```

### 12.3 Frequencies EMPSTATD

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
EMPSTATD<- EMPSTAT%>% 
  group_by(as_factor(EMPSTATD)) %>% 
  summarise(n=n())%>% 
  mutate(n_rel = round(n / sum(n)*100,2))

kbl(EMPSTAT0, booktabs = T)%>%kable_styling(full_width = T,position = "center") %>%
column_spec(1, width = "30em")

```

### 12.4 NAs in EMPSTAT_HEAD, EMPSTAT_MOM, EMPSTAT_POP, EMPSTAT_SP

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
EMPSTAT1<-df%>%
  select(EMPSTAT_HEAD, EMPSTAT_MOM, EMPSTAT_POP, EMPSTAT_SP)
vis_miss(EMPSTAT1,warn_large_data=FALSE)+
  theme(legend.title = element_blank(),
        legend.text = element_text(colour="black",face="bold", size = 15),
        axis.text  = element_text(angle = 0,vjust=0.5, size=15,colour="black"),
        axis.text.x  = element_text(angle = 0,vjust=0.5, size=15,colour="black",hjust=.5),
        axis.title  = element_text(angle = 0,vjust=0.5, size=15,colour="black")) 
```

### 12.5 Frequencies EMPSTAT_HEAD

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
EMPSTAT_HEAD<- EMPSTAT1%>% 
  group_by(as_factor(EMPSTAT_HEAD)) %>% 
  summarise(n=n())%>% 
  mutate(n_rel = round(n / sum(n)*100,2))

kbl(EMPSTAT_HEAD, booktabs = T)%>%kable_styling(full_width = T,position = "center") %>%
column_spec(1, width = "30em")

```

### 12.6 Frequencies EMPSTAT_MOM

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
EMPSTAT_MOM<- EMPSTAT1%>% 
  group_by(as_factor(EMPSTAT_MOM)) %>% 
  summarise(n=n())%>% 
  mutate(n_rel = round(n / sum(n)*100,2))

kbl(EMPSTAT_MOM, booktabs = T)%>%kable_styling(full_width = T,position = "center") %>%
column_spec(1, width = "30em")

```

### 12.7 Frequencies EMPSTAT_POP

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
EMPSTAT_POP<- EMPSTAT1%>% 
  group_by(as_factor(EMPSTAT_POP)) %>% 
  summarise(n=n())%>% 
  mutate(n_rel = round(n / sum(n)*100,2))

kbl(EMPSTAT_POP, booktabs = T)%>%kable_styling(full_width = T,position = "center") %>%
column_spec(1, width = "30em")

```

### 12.8 Frequencies EMPSTAT_SP

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
EMPSTAT_SP<- EMPSTAT1%>% 
  group_by(as_factor(EMPSTAT_SP)) %>% 
  summarise(n=n())%>% 
  mutate(n_rel = round(n / sum(n)*100,2))

kbl(EMPSTAT_SP, booktabs = T)%>%kable_styling(full_width = T,position = "center") %>%
column_spec(1, width = "30em")

```

### 12.9 NAs in LABFORCE

`r attributes(df$LABFORCE)$var_desc`

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
LABFORCE0<-df%>%
  select(LABFORCE)
vis_miss(LABFORCE0,warn_large_data=FALSE)+
  theme(legend.title = element_blank(),
        legend.text = element_text(colour="black",face="bold", size = 15),
        axis.text  = element_text(angle = 0,vjust=0.5, size=15,colour="black"),
        axis.text.x  = element_text(angle = 0,vjust=0.5, size=15,colour="black",hjust=.5),
        axis.title  = element_text(angle = 0,vjust=0.5, size=15,colour="black")) 
```

### 12.10 Frequencies in LABFORCE

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
LABFORCE<- LABFORCE0%>% 
  group_by(as_factor(LABFORCE)) %>% 
  summarise(n=n())%>% 
  mutate(n_rel = round(n / sum(n)*100,2))

kbl(LABFORCE, booktabs = T)%>%kable_styling(full_width = T,position = "center") %>%
column_spec(1, width = "30em")
```

### 12.11 NAs in OCCISCO

`r attributes(df$OCCISCO)$var_desc`

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
OCCISCO0<-df%>%
  select(OCCISCO)
vis_miss(OCCISCO0,warn_large_data=FALSE)+
  theme(legend.title = element_blank(),
        legend.text = element_text(colour="black",face="bold", size = 15),
        axis.text  = element_text(angle = 0,vjust=0.5, size=15,colour="black"),
        axis.text.x  = element_text(angle = 0,vjust=0.5, size=15,colour="black",hjust=.5),
        axis.title  = element_text(angle = 0,vjust=0.5, size=15,colour="black")) 
```

### 12.12 Frequencies in OCCISCO

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
OCCISCO<- OCCISCO0%>% 
  group_by(as_factor(OCCISCO)) %>% 
  summarise(n=n())%>% 
  mutate(n_rel = round(n / sum(n)*100,2))

kbl(OCCISCO, booktabs = T)%>%kable_styling(full_width = T,position = "center") %>%
column_spec(1, width = "30em")
```

### 12.13 STATUS OF ECONOMICALLY ACTIVE PERSON: CLASSWK

`r attributes(df$CLASSWK)$var_desc`

### 12.14 NAs in CLASSWK, CLASSWKD

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
CLASSWK0<-df%>%
  select(CLASSWK, CLASSWKD)
vis_miss(CLASSWK0,warn_large_data=FALSE)+
  theme(legend.title = element_blank(),
        legend.text = element_text(colour="black",face="bold", size = 15),
        axis.text  = element_text(angle = 0,vjust=0.5, size=15,colour="black"),
        axis.text.x  = element_text(angle = 0,vjust=0.5, size=15,colour="black",hjust=.5),
        axis.title  = element_text(angle = 0,vjust=0.5, size=15,colour="black")) 
```

### 12.15 Frequencies in CLASSWK

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
CLASSWK<- CLASSWK0%>% 
  group_by(as_factor(CLASSWK)) %>% 
  summarise(n=n())%>% 
  mutate(n_rel = round(n / sum(n)*100,2))

kbl(CLASSWK, booktabs = T)%>%kable_styling(full_width = T,position = "center") %>%
column_spec(1, width = "30em")
```

### 12.16 Frequencies in CLASSWKD

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
CLASSWKD<- CLASSWK0%>% 
  group_by(as_factor(CLASSWKD)) %>% 
  summarise(n=n())%>% 
  mutate(n_rel = round(n / sum(n)*100,2))

kbl(CLASSWKD, booktabs = T)%>%kable_styling(full_width = T,position = "center") %>%
column_spec(1, width = "30em")
```

### 12.17 NAs in INDGEN

`r attributes(df$INDGEN)$var_desc`

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
INDGEN0<-df%>%
  select(INDGEN)
vis_miss(INDGEN0,warn_large_data=FALSE)+
  theme(legend.title = element_blank(),
        legend.text = element_text(colour="black",face="bold", size = 15),
        axis.text  = element_text(angle = 0,vjust=0.5, size=15,colour="black"),
        axis.text.x  = element_text(angle = 0,vjust=0.5, size=15,colour="black",hjust=.5),
        axis.title  = element_text(angle = 0,vjust=0.5, size=15,colour="black")) 
```

### 12.18 Frequencies in INDGEN

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
INDGEN<- INDGEN0%>% 
  group_by(as_factor(INDGEN)) %>% 
  summarise(n=n())%>% 
  mutate(n_rel = round(n / sum(n)*100,2))

kbl(INDGEN, booktabs = T)%>%kable_styling(full_width = T,position = "center") %>%
column_spec(1, width = "30em")
```

### 13. NAs in OWNERSHIP, OWNERSHIPD, HHTYPE

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
OWNHHT<-df%>%
  select(OWNERSHIP, OWNERSHIPD, HHTYPE)
vis_miss(OWNHHT,warn_large_data=FALSE)+
  theme(legend.title = element_blank(),
        legend.text = element_text(colour="black",face="bold", size = 15),
        axis.text  = element_text(angle = 0,vjust=0.5, size=15,colour="black"),
        axis.text.x  = element_text(angle = 0,vjust=0.5, size=15,colour="black",hjust=.5),
        axis.title  = element_text(angle = 0,vjust=0.5, size=15,colour="black")) 
```

### 13.1 Frequencies OWNERSHIP

`r attributes(df$OWNERSHIP)$var_desc`

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
OWNERSHIP<- OWNHHT%>% 
  group_by(as_factor(OWNERSHIP)) %>% 
  summarise(n=n())%>% 
  mutate(n_rel = round(n / sum(n)*100,2))

kbl(OWNERSHIP, booktabs = T)%>%kable_styling(full_width = T,position = "center") %>%
column_spec(1, width = "30em")

```

### 13.2 Frequencies OWNERSHIPD

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
OWNERSHIPD<- OWNHHT%>% 
  group_by(as_factor(OWNERSHIPD)) %>% 
  summarise(n=n())%>% 
  mutate(n_rel = round(n / sum(n)*100,2))

kbl(OWNERSHIPD, booktabs = T)%>%kable_styling(full_width = T,position = "center") %>%
column_spec(1, width = "30em")

```

### 13.3 Frequencies HHTYPE

`r attributes(df$HHTYPE)$var_desc`

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
HHTYPE<- OWNHHT%>% 
  group_by(as_factor(HHTYPE)) %>% 
  summarise(n=n())%>% 
  mutate(n_rel = round(n / sum(n)*100,2))

kbl(HHTYPE, booktabs = T)%>%kable_styling(full_width = T,position = "center") %>%
column_spec(1, width = "30em")

```

### 14. MARITAL STATUS: MARST

`r attributes(df$MARST)$var_desc`

### 14.1 NAs in MARST, MARSTD, CONSENS

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
MARS<-df%>%
  select(MARST, MARSTD, CONSENS)
vis_miss(MARS,warn_large_data=FALSE)+
  theme(legend.title = element_blank(),
        legend.text = element_text(colour="black",face="bold", size = 15),
        axis.text  = element_text(angle = 0,vjust=0.5, size=15,colour="black"),
        axis.text.x  = element_text(angle = 0,vjust=0.5, size=15,colour="black",hjust=.5),
        axis.title  = element_text(angle = 0,vjust=0.5, size=15,colour="black")) 
```

### 14.2 Frequencies MARST

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
MARST<- MARS%>% 
  group_by(as_factor(MARST)) %>% 
  summarise(n=n())%>% 
  mutate(n_rel = round(n / sum(n)*100,2))

kbl(MARST, booktabs = T)%>%kable_styling(full_width = T,position = "center") %>%
column_spec(1, width = "30em")

```

### 14.3 Frequencies MARSTD

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
MARSTD<- MARS%>% 
  group_by(as_factor(MARSTD)) %>% 
  summarise(n=n())%>% 
  mutate(n_rel = round(n / sum(n)*100,2))

kbl(MARSTD, booktabs = T)%>%kable_styling(full_width = T,position = "center") %>%
column_spec(1, width = "30em")

```

### 14.4 Frequencies CONSENS

`r attributes(df$CONSENS)$var_desc`

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
CONSENS<- MARS%>% 
  group_by(as_factor(CONSENS)) %>% 
  summarise(n=n())%>% 
  mutate(n_rel = round(n / sum(n)*100,2))

kbl(CONSENS, booktabs = T)%>%kable_styling(full_width = T,position = "center") %>%
column_spec(1, width = "30em")

```

### 15. NAs in REGIONW, GEOLEV1, GEOLEV2

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
GEO<-df%>%
  select(REGIONW, GEOLEV1, GEOLEV2)
vis_miss(GEO,warn_large_data=FALSE)+
  theme(legend.title = element_blank(),
        legend.text = element_text(colour="black",face="bold", size = 15),
        axis.text  = element_text(angle = 0,vjust=0.5, size=15,colour="black"),
        axis.text.x  = element_text(angle = 0,vjust=0.5, size=15,colour="black",hjust=.5),
        axis.title  = element_text(angle = 0,vjust=0.5, size=15,colour="black")) 
```

### 15.1 Frequencies REGIONW

`r attributes(df$REGIONW)$var_desc`

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
REGIONW<- GEO%>%
  group_by(as_factor(REGIONW)) %>% 
  summarise(n=n())%>% 
  mutate(n_rel = round(n / sum(n)*100,2))

kbl(REGIONW, booktabs = T)%>%kable_styling(full_width = T,position = "center") %>%
column_spec(1, width = "30em")

```

### 15.2 Frequencies GEOLEV1

`r attributes(df$GEOLEV1)$var_desc`

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
GEOLEV1<- GEO%>%
  group_by(as_factor(GEOLEV1)) %>% 
  summarise(n=n())%>% 
  mutate(n_rel = round(n / sum(n)*100,2))

kbl(GEOLEV1, booktabs = T)%>%kable_styling(full_width = T,position = "center") %>%
column_spec(1, width = "30em")

```

### 16. NAs in PERNUM, PERWT

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
PER<-df%>%
  select(PERNUM, PERWT)
vis_miss(PER,warn_large_data=FALSE)+
  theme(legend.title = element_blank(),
        legend.text = element_text(colour="black",face="bold", size = 15),
        axis.text  = element_text(angle = 0,vjust=0.5, size=15,colour="black"),
        axis.text.x  = element_text(angle = 0,vjust=0.5, size=15,colour="black",hjust=.5),
        axis.title  = element_text(angle = 0,vjust=0.5, size=15,colour="black")) 
```

### 16.1 Frequencies PERNUM

`r attributes(df$PERNUM)$var_desc`

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
PERNUM<- PER%>%
  group_by(as_factor(PERNUM)) %>% 
  summarise(n=n())%>% 
  mutate(n_rel = round(n / sum(n)*100,2))

kbl(PERNUM, booktabs = T)%>%kable_styling(full_width = T,position = "center") %>%
column_spec(1, width = "30em")

```

### 16.2 Frequencies PERWT

`r attributes(df$PERWT)$var_desc`

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
PERWT<- PER%>%
  group_by(as_factor(PERWT)) %>% 
  summarise(n=n())%>% 
  mutate(n_rel = round(n / sum(n)*100,2))

kbl(PERWT, booktabs = T)%>%kable_styling(full_width = T,position = "center") %>%
column_spec(1, width = "30em")

```

### 17. Crosstables

### 17.1 MOMLOC-RELATE

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE

RELATE_MOMLOC<-df %>% 
  select(MOMLOC,RELATE)

kbl(table(as_factor(RELATE_MOMLOC$MOMLOC),as_factor(RELATE_MOMLOC$RELATE),useNA="always"),
    booktabs = T)%>%kable_styling(full_width = T,position = "center",font_size = 9)#%>% 
#column_spec(1, width = "20em")
```

### 17.2 POPLOC-RELATE

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
RELATE_POPLOC<-df %>% 
  select(POPLOC,RELATE)

kbl(table(as_factor(RELATE_POPLOC$POPLOC),as_factor(RELATE_POPLOC$RELATE),useNA="always"),
    booktabs = T)%>%kable_styling(full_width = T,position = "center",font_size = 9)
```

### 17.3 SPLOC-RELATE

```{r fig.width=12, fig.height=6}
#| echo: false
#| warning: FALSE
RELATE_SPLOC<-df %>% 
  select(SPLOC,RELATE)

kbl(table(as_factor(RELATE_SPLOC$SPLOC),as_factor(RELATE_SPLOC$RELATE),useNA="always"),
    booktabs = T)%>%kable_styling(full_width = T,position = "center",font_size = 9)
```

### 17.4 AGE x SEX x MARST (Graph)

```{r fig.width=12, fig.height=10}
#| echo: false
#| warning: FALSE
SEX<- df%>% #nota: tambien hay informacion sobre la cantidad de habitaciones lo que puede dar una idea del tamaÃ±o de la casa
  group_by(as_factor(SEX),as_factor(df$AGE2),as_factor(df$MARST)) %>% 
  summarise(n=n())%>% 
  mutate(n_rel = round(n / sum(n)*100,2))

colnames(SEX)<-c("Sex", "Age2", "Mars", "n", "rel")

levels(SEX$Mars)<-c("NIU (not in universe)",
                    "Single /\nnever married",
                     "Married /\nin union",
                     "Separated/divorced /\nspouse absent",
                     "Widowed","Unknown /\nmissing")

ggplot(SEX[SEX$Sex!="Unknown",], aes(x=Age2, y=n,fill=Mars)) + 
  geom_bar(stat = "identity", colour="black", size=.01)+
  coord_flip()+
  facet_grid (Sex~Mars)+
  theme(plot.title = element_text(lineheight=5.6, vjust=1.5,size=12, face="bold"),
        legend.title = element_blank(),
        legend.text = element_text(colour="black", size = 12),
        legend.position="none",
        axis.text.y = element_text(colour="black", size = 14),
        axis.text.x = element_blank(),
        axis.title.y = element_blank(),
        axis.title.x = element_blank(),
        axis.ticks.x = element_blank(),
        strip.text.x = element_text(size = 14, face="bold"),
        strip.text.y = element_text(size = 14, face="bold"),
        
        legend.background = element_rect(fill = NA),
        panel.background = element_rect(fill = "#ffffff"),
        plot.background = element_rect(fill = "#ffffff"),
        panel.grid.major=element_line(colour="#f2f2f2",size = .2), 
        panel.grid.minor=element_line(colour=NA))

```

### 17.5 AGE x SEX x EDATTAIN (Graph)

```{r fig.width=12, fig.height=10}
#| echo: false
#| warning: FALSE
EDATTAIN<- df%>% #nota: tambien hay informacion sobre la cantidad de habitaciones lo que puede dar una idea del tamaÃ±o de la casa
  group_by(as_factor(SEX),as_factor(df$AGE2),as_factor(df$EDATTAIN)) %>% 
  summarise(n=n())%>% 
  mutate(n_rel = round(n / sum(n)*100,2))

colnames(EDATTAIN)<-c("Sex", "Age2", "Education", "n", "rel")

levels(EDATTAIN$Education)<-c("NIU\n(not in universe)",
                              "Less than\nprimary completed",
                              "Primary\ncompleted",
                              "Secondary\ncompleted",
                              "University\ncompleted",
                              "Unknown")

ggplot(EDATTAIN[EDATTAIN$Sex!="Unknown",], aes(x=Age2, y=n,fill=Education)) + 
  geom_bar(stat = "identity", colour="black", size=.01)+
  coord_flip()+
  facet_grid (Sex~Education)+
  theme(plot.title = element_text(lineheight=5.6, vjust=1.5,size=12, face="bold"),
        legend.title = element_blank(),
        legend.text = element_text(colour="black", size = 12),
        legend.position="none",
        axis.text.y = element_text(colour="black", size = 14),
        axis.text.x = element_blank(),
        axis.title.y = element_blank(),
        axis.title.x = element_blank(),
        axis.ticks.x = element_blank(),
        strip.text.x = element_text(size = 14, face="bold"),
        strip.text.y = element_text(size = 14, face="bold"),
        
        legend.background = element_rect(fill = NA),
        panel.background = element_rect(fill = "#ffffff"),
        plot.background = element_rect(fill = "#ffffff"),
        panel.grid.major=element_line(colour="#f2f2f2",size = .2), 
        panel.grid.minor=element_line(colour=NA))

```

### 17.6 AGE x SEX x RELATE (Graph)

```{r fig.width=12, fig.height=10}
#| echo: false
#| warning: FALSE
RELATE<- df%>% #nota: tambien hay informacion sobre la cantidad de habitaciones lo que puede dar una idea del tamaÃ±o de la casa
  group_by(as_factor(SEX),as_factor(df$AGE2),as_factor(df$RELATE)) %>% 
  summarise(n=n())%>% 
  mutate(n_rel = round(n / sum(n)*100,2))

colnames(RELATE)<-c("Sex", "Age2", "Relate", "n", "rel")

levels(RELATE$Relate)<-c("Head",
                         "Spouse/\npartner",
                         "Child", 
                         "Other\nrelative",
                         "Other relative or\n non-relative",
                         "Non\nrelative",
                         "Unknown")

ggplot(RELATE[RELATE$Sex!="Unknown",], aes(x=Age2, y=n,fill=Relate)) + 
  geom_bar(stat = "identity", colour="black", size=.01)+
  coord_flip()+
  facet_grid (Sex~Relate)+
  theme(plot.title = element_text(lineheight=5.6, vjust=1.5,size=12, face="bold"),
        legend.title = element_blank(),
        legend.text = element_text(colour="black", size = 12),
        legend.position="none",
        axis.text.y = element_text(colour="black", size = 14),
        axis.text.x = element_blank(),
        axis.title.y = element_blank(),
        axis.title.x = element_blank(),
        axis.ticks.x = element_blank(),
        strip.text.x = element_text(size = 14, face="bold"),
        strip.text.y = element_text(size = 14, face="bold"),
        
        legend.background = element_rect(fill = NA),
        panel.background = element_rect(fill = "#ffffff"),
        plot.background = element_rect(fill = "#ffffff"),
        panel.grid.major=element_line(colour="#f2f2f2",size = .2), 
        panel.grid.minor=element_line(colour=NA))

```
